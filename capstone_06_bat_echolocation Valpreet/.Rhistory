title = "Frequency vs Duration of Bat Calls",
x = "Duration (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
# If you have GGally installed, you can use ggpairs for multivariate exploration
# install.packages("GGally")  # run once if not installed
library(GGally)
bat_data %>%
select(duration, frequency, slope, time_btw_calls, species) %>%
ggpairs(mapping = aes(color = species))
##Load needed package
#for multinomial logistic regression
library(nnet)
#split data into training and testing sets
set.seed(123)  # ensures results are reproducible
#create a training index (70% train, 30% test)
train_index <- sample(1:nrow(bat_data), size = 0.7 * nrow(bat_data))
# Split into training and test sets
train_data <- bat_data[train_index, ]
test_data  <- bat_data[-train_index, ]
##fit multinomial logistic regression
model <- multinom(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data
)
#view model summary
summary(model)
### Make predictions on the test set
#predict species for test data
predicted_species <- predict(model, newdata = test_data)
#compare predicted vs actual species
predicted_species
## Model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
accuracy
# Confusion matrix
table(
Actual = test_data$species,
Predicted = predicted_species
)
test_data  <- bat_data[-train_index, ]
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
print("Accuracy:", accuracy)
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
print("Accuracy:",accuracy)
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
accuracy
#import necessary libraries
library(tidyverse)
library(janitor)
library(knitr)
#import necessary libraries for this project
library(tidyverse)
library(janitor)
library(knitr)
#create summary table with selected statistics
summary_table <- bat_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
#scaterplot exploring relationship between duration and frequency
bat_data %>%
ggplot(aes(x = duration, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Frequency vs Duration of Bat Calls",
x = "Duration (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#defining the variable types
bat_data <- bat_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_data)
#defining the variable types
bat_data <- bat_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_data)
head(bat_data)
#import  data
bat_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows of th impoteed data
head(bat_data)
#inspect structure of imported data
glimpse(bat_data)
#import necessary libraries for this project
library(tidyverse)
library(janitor)
library(knitr)
#import  data
bat_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows of th impoteed data
head(bat_data)
#inspect structure of imported data
glimpse(bat_data)
#defining the variable types
bat_data <- bat_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_data)
##identify duplicated rows from the data
duplicates <- bat_data %>% duplicated()
#Count how many duplicates exist
sum(duplicates)
#remove duplicated rows if any
bat_data <- bat_data %>% distinct()
##confirm duplicates are removed
sum(duplicated(bat_data))
#Arrange data by species, then by filename
bat_data <- bat_data %>% arrange(species, filename)
#display arranged data
head(bat_data)
# Summary statistics grouped by species
summary_table <- bat_data %>%
group_by(species) %>%        # Group by species
summarise(
mean_duration = mean(duration, na.rm = TRUE),
sd_duration = sd(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
summary_table
##create a standardized frequency variable
bat_data <- bat_data %>%
mutate(
frequency_z = scale(frequency) %>% as.numeric()#convert to numerc
)
#check updated dataset
glimpse(bat_data)
#create summary table with selected statistics
summary_table <- bat_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
###boxplot of frequency across species
bat_data %>%
ggplot(aes(x = species, y = frequency, fill = species)) +
geom_boxplot() +
labs(
title = "Frequency Distribution by Species",
x = "Species",
y = "Frequency (kHz)"
) +
theme_minimal()
#scaterplot exploring relationship between duration and frequency
bat_data %>%
ggplot(aes(x = duration, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Frequency vs Duration of Bat Calls",
x = "Duration (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#scatterplot showing time between calls and frequency
bat_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time Between Calls vs Frequency",
x = "Time Between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#density plot showing frequency distributions of the species
bat_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density Plot of Call Frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
##Load needed package
#for multinomial logistic regression
library(nnet)
#split data into training and testing sets
set.seed(123)  # ensures results are reproducible
#create a training index (70% train, 30% test)
train_index <- sample(1:nrow(bat_data), size = 0.7 * nrow(bat_data))
##Split into training and test sets
train_data <- bat_data[train_index, ]
test_data  <- bat_data[-train_index, ]
##fit multinomial logistic regression
model <- multinom(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data
)
#view model summary
summary(model)
#predict species for test data
predicted_species <- predict(model, newdata = test_data)
#compare predicted vs actual species
predicted_species
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
accuracy
# Confusion matrix
table(
Actual = test_data$species,
Predicted = predicted_species
)
###densityplot showng frequency distributionss of the species
bat_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density plot of Call frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
##scaterplot showing time between calls and frequency
bat_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time between calls vs Frequency",
x = "Time between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
##create a standardized frequency variable
bat_data <- bat_data %>%
mutate(
frequency_z =scale(frequency) %>% as.numeric()#convert to numerc
)
#check updated dataset
glimpse(bat_data)
View(test_data)
library(knitr)#for formated tables
#import necessary libraries for this project
library(tidyverse) #for libraries like ggplot etc.
library(janitor)#for data cleaning
library(knitr)#for formated tables
#import necessary libraries for this project
library(tidyverse) #for libraries like ggplot etc.
library(janitor)#for data cleaning
library(knitr)#for formated tables
#import bat_call_data.csv data file
bat_call_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows
head(bat_call_data)
#structure of thedata
glimpse(bat_data)
#import bat_call_data.csv data file
bat_call_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows
head(bat_call_data)
#structure of thedata
glimpse(bat_call_data)
bat_call_data <- bat_call_data %>%
clean_names() %>% ##function to clean names
mutate(
species = as.factor(species), #read spicieas as a factor
filename = as.character(filename),#change filename to character type
time_btw_calls = as.numeric(time_btw_calls),#change time_btwn calls tp numeric
duration = as.numeric(duration),#change to numeric
frequency = as.numeric(frequency),#change frequency to numeric
slope = as.numeric(slope)#change the slopeto numeric
)
#see the changes made in the structure
glimpse(bat_call_data)
#find duplicates from the dataset
dup_data <- bat_call_data %>% duplicated()
#remove duplcat records fromthe dataset
bat_call_data <- bat_call_data %>% distinct()
#sort by species and filename for easier view
bat_call_data <- bat_call_data %>% arrange(species, filename)
#first few rows of sorted data
head(bat_call_data)
#display summary statistics grouped by species
summary_stats <- bat_call_data %>%
group_by(species) %>%        # Group by species
summarise(
mean_duration = mean(duration, na.rm = TRUE),#mean duration for each
sd_duration = sd(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
#display summary tabel
summary_stats
# Function to calculate mean and standard deviation for a numeric variable
mean_sd <- function(x) {
c(
mean = mean(x, na.rm = TRUE),
sd   = sd(x, na.rm = TRUE)
)
}
# Apply the function to each call parameter by species
summary_stats <- bat_call_data %>%
group_by(species) %>%
summarise(
duration     = list(mean_sd(duration)),
frequency    = list(mean_sd(frequency)),
time_btw     = list(mean_sd(time_btw_calls)),
slope        = list(mean_sd(slope)),
.groups = "drop"
)
# Display the summary table
summary_stats
#display summary statistics grouped by species
summary_stats <- bat_call_data %>%
group_by(species) %>%        # Group by species
summarise(
mean_duration = mean(duration, na.rm = TRUE),#mean duration for each
sd_duration = sd(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
#display summary tabel
summary_stats
# Function to calculate summary statistics by species
summarize_by_species <- function(data) {
data %>%
group_by(species) %>%
summarise(
mean_duration   = mean(duration, na.rm = TRUE),
sd_duration     = sd(duration, na.rm = TRUE),
mean_frequency  = mean(frequency, na.rm = TRUE),
sd_frequency    = sd(frequency, na.rm = TRUE),
mean_time_btw   = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw     = sd(time_btw_calls, na.rm = TRUE),
mean_slope      = mean(slope, na.rm = TRUE),
sd_slope        = sd(slope, na.rm = TRUE)
)
}
# Use the function to generate the summary table
summary_stats <- summarize_by_species(bat_call_data)
# Display the summary table
summary_stats
##function to calculate summary statistics by species
summarize_by_species <- function(data) {
data %>%
group_by(species) %>%
summarise(
mean_duration   = mean(duration, na.rm = TRUE),
sd_duration     = sd(duration, na.rm = TRUE),
mean_frequency  = mean(frequency, na.rm = TRUE),
sd_frequency    = sd(frequency, na.rm = TRUE),
mean_time_btw   = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw     = sd(time_btw_calls, na.rm = TRUE),
mean_slope      = mean(slope, na.rm = TRUE),
sd_slope        = sd(slope, na.rm = TRUE)
)
}
## generate the summary table usig the funcion
summary_stats <- summarize_by_species(bat_call_data)
#display the sumary table
summary_stats
##create sumary table with selected statistics
summary_table <- bat_call_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
#function create sumary table with selected statistics for species
create_species_summary <- function(data) {
data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
}
#generate the summary table using the function
summary_table <- create_species_summary(bat_call_data)
##display table output
kable(summary_table,caption = "Summary Statistics for Each Bat Species")
#plot of frequncy vs duration of the spcies
bat_call_data %>%
ggplot(aes(x = duration, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Frequency vs Duration of Bat Calls",##plot title
x = "Duration in ms",
y = "Frequency in kHz"
) +
theme_minimal()
bat_call_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time between calls vs Frequency",
x = "Time between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
bat_call_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density plot for Call frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
##Load needed package logistic regression
library(nnet)
#spliting the data into training and testing
set.seed(123)
#training index (70% train data and 30% test)
training_index <- sample(1:nrow(bat_call_data), size = 0.7 * nrow(bat_call_data))
##Split into training and test sets
training_data <- bat_call_data[training_index, ]
testing_data  <- bat_call_data[-training_index, ]
#spliting the data into training and testing
set.seed(123)
#training index (70% train data and 30% test)
training_index <- sample(1:nrow(bat_call_data), size = 0.7 * nrow(bat_call_data))
##Split into training and test sets
training_data <- bat_call_data[training_index, ]
testing_data  <- bat_call_data[-training_index, ]
##fit multinomial logistic regression with all the 4 numric parameters
model <- multinom(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data
)
##fit multinomial logistic regression with all the 4 numric parameters
model <- multinom(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data
)
summary(model)
#make predictions of the species on test data
predicted_species <- predict(model, newdata = test_data)
#make predictions of the species on test data
predicted_species <- predict(model, newdata = testing_data)
#compare predictions on the actual species
predicted_species
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
## model accuracy
accuracy <- mean(predicted_species == testing_data$species)
accuracy
# Confusion matrix
table(
Actual = testing_data$species,
Predicted = predicted_species
)
