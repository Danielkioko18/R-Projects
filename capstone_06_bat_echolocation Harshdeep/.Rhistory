##display table
kable(species_stats_table, caption = "Summary Statistics for each Species")
echolocation_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time btwn calls vs Frequency",
x = "Time between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#============================ Create train and test data ===========================
#import library
library(randomForest)
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
train_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
train_data <- echolocation_data[train_index, ]
test_data  <- echolocation_data[-train_index, ]
#============fit th model ==========
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
train_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
train_data <- echolocation_data[train_index, ]
test_data  <- echolocation_data[-train_index, ]
#============fit th model ==========
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
rf_predictions <- predict(rf_model, newdata = test_data)
rf_predictions
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
train_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
train_data <- echolocation_data[train_index, ]
test_data  <- echolocation_data[-train_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
#make predictions
rf_predictions <- predict(rf_model, newdata = test_data)
rf_predictions
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
randomforest_predictions
## calculate the accuracy
rf_accuracy <- mean(rf_predictions == testing_data$species)
rf_accuracy
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
randomforest_predictions
## calculate the accuracy
rf_accuracy <- mean(rf_predictions == testing_data$species)
print(printf("\nAccuracy: ", rf_accuracy))rf_accuracy
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
randomforest_predictions
## calculate the accuracy
rf_accuracy <- mean(rf_predictions == testing_data$species)
print("\nAccuracy: ", rf_accuracy))rf_accuracy
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
randomforest_predictions
## calculate the accuracy
rf_accuracy <- mean(rf_predictions == testing_data$species)
print("\nAccuracy: ", rf_accuracy))
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
randomforest_predictions
## calculate the accuracy
rf_accuracy <- mean(rf_predictions == testing_data$species)
print("\nAccuracy: ", rf_accuracy)
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
print("Accuracy: ", rf_accuracy)
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
rf_accuracy
table(
Actual = testing_data$species,
Predicted = randomforest_predictions
)
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
rf_accuracy
#confusion matrix of the model
table(
Actual = testing_data$species,
Predicted = randomforest_predictions
)
print("\n")
print(\n)
print(sprintf("Accuracy: %.4f", rf_accuracy))
print(sprintf("Accuracy: %.4f", rf_accuracy, "\n"))
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
##ccreate an index for 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
print(sprintf("Accuracy: %.4f", rf_accuracy,)
print()
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
## 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data into training and testing
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
print(sprintf("Accuracy: %.4f", rf_accuracy))
print()
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
## 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data into training and testing
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(rf_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
print(sprintf("Accuracy: %.4f", rf_accuracy))
#confusion matrix of the model
table(
Actual = testing_data$species,
Predicted = randomforest_predictions
)
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
## 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data into training and testing
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(randomforest_model, newdata = test_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
print(sprintf("Accuracy: %.4f", rf_accuracy))
#confusion matrix of the model
table(
Actual = testing_data$species,
Predicted = randomforest_predictions
)
##import libraries for this project
library(tidyverse)
library(janitor)
library(knitr)
#read bat echolocation data from the csv
echolocation_data <- read_csv("Bat_Call_Data.csv")
#view output
head(echolocation_data)
#view the data structire
glimpse(echolocation_data)
## Convert and define variable types for th dataset
echolocation_data <- echolocation_data %>%
clean_names() %>% ## Standardize column names removing spaces & special characters
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
##Display the updated data structure
glimpse(echolocation_data)
#================== Identify and delete duplicate records ===============
# Check for any duplicate rows in the dataset
duplicates <- echolocation_data %>% duplicated()
#delete the duplicate rows
echolocation_data <- echolocation_data %>% distinct()#clean data
#Sort the dataset first by 'species' and then by filename'
echolocation_data <- echolocation_data %>% arrange(species, filename)
#view sorted data
head(echolocation_data)
# Calculate summary statistics for each echolocation parameter, grouped by species
species_stats<- echolocation_data %>%
group_by(species) %>% # Group the data based on the 'species column
summarise(
mean_duration = mean(duration, na.rm = TRUE),# Mean call duration
sd_duration = sd(duration, na.rm = TRUE), #Standard deviation of call duration
mean_frequency = mean(frequency, na.rm = TRUE),# Standard deviation of max freq
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
## Display the resulting summary statitics table
species_stats
##=================== Summary statistics table for selected stats==================
species_stats_table <- echolocation_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(species_stats_table, caption = "Summary Statistics for each Species")
#============Scatter plot Time between calls vs frequency ================
echolocation_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time btwn calls vs Frequency",
x = "Time between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#=================Densityplot: frequency distribution by species ================
echolocation_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density plot of Call frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
#====================== Boxplot: frequency distribution by spewcies==============
echolocation_data %>%
ggplot(aes(x = species, y = frequency, fill =species)) +
geom_boxplot() +
labs(
title = "Frequency distribution by species",
x = "Species",
y= "Frequency (kHz)"
) +
theme_minimal()
#============================ Create train and test data ===========================
#import library
library(randomForest)
set.seed(123)
## 70% training data
training_index <- sample(
1:nrow(echolocation_data),
size = 0.7 * nrow(echolocation_data)
)
#split the data into training and testing
training_data <- echolocation_data[training_index, ]
testing_data  <- echolocation_data[-training_index, ]
#============fit the model to numeric parameters of the data ==========
randomforest_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = training_data,
ntree = 300,
mtry = 2
)
#make predictions
randomforest_predictions <- predict(randomforest_model, newdata = testing_data)
## calculate the accuracy
rf_accuracy <- mean(randomforest_predictions == testing_data$species)
print(sprintf("Accuracy: %.4f", rf_accuracy))
#confusion matrix of the model
table(
Actual = testing_data$species,
Predicted = randomforest_predictions
)
