)
test_data  <- bat_data[-train_index, ]
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
print("Accuracy:", accuracy)
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
print("Accuracy:",accuracy)
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
accuracy
#import necessary libraries
library(tidyverse)
library(janitor)
library(knitr)
#import necessary libraries for this project
library(tidyverse)
library(janitor)
library(knitr)
#create summary table with selected statistics
summary_table <- bat_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
#scaterplot exploring relationship between duration and frequency
bat_data %>%
ggplot(aes(x = duration, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Frequency vs Duration of Bat Calls",
x = "Duration (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#defining the variable types
bat_data <- bat_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_data)
#defining the variable types
bat_data <- bat_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_data)
head(bat_data)
#import  data
bat_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows of th impoteed data
head(bat_data)
#inspect structure of imported data
glimpse(bat_data)
#import necessary libraries for this project
library(tidyverse)
library(janitor)
library(knitr)
#import  data
bat_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows of th impoteed data
head(bat_data)
#inspect structure of imported data
glimpse(bat_data)
#defining the variable types
bat_data <- bat_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_data)
##identify duplicated rows from the data
duplicates <- bat_data %>% duplicated()
#Count how many duplicates exist
sum(duplicates)
#remove duplicated rows if any
bat_data <- bat_data %>% distinct()
##confirm duplicates are removed
sum(duplicated(bat_data))
#Arrange data by species, then by filename
bat_data <- bat_data %>% arrange(species, filename)
#display arranged data
head(bat_data)
# Summary statistics grouped by species
summary_table <- bat_data %>%
group_by(species) %>%        # Group by species
summarise(
mean_duration = mean(duration, na.rm = TRUE),
sd_duration = sd(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
summary_table
##create a standardized frequency variable
bat_data <- bat_data %>%
mutate(
frequency_z = scale(frequency) %>% as.numeric()#convert to numerc
)
#check updated dataset
glimpse(bat_data)
#create summary table with selected statistics
summary_table <- bat_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
###boxplot of frequency across species
bat_data %>%
ggplot(aes(x = species, y = frequency, fill = species)) +
geom_boxplot() +
labs(
title = "Frequency Distribution by Species",
x = "Species",
y = "Frequency (kHz)"
) +
theme_minimal()
#scaterplot exploring relationship between duration and frequency
bat_data %>%
ggplot(aes(x = duration, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Frequency vs Duration of Bat Calls",
x = "Duration (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#scatterplot showing time between calls and frequency
bat_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time Between Calls vs Frequency",
x = "Time Between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
#density plot showing frequency distributions of the species
bat_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density Plot of Call Frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
##Load needed package
#for multinomial logistic regression
library(nnet)
#split data into training and testing sets
set.seed(123)  # ensures results are reproducible
#create a training index (70% train, 30% test)
train_index <- sample(1:nrow(bat_data), size = 0.7 * nrow(bat_data))
##Split into training and test sets
train_data <- bat_data[train_index, ]
test_data  <- bat_data[-train_index, ]
##fit multinomial logistic regression
model <- multinom(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data
)
#view model summary
summary(model)
#predict species for test data
predicted_species <- predict(model, newdata = test_data)
#compare predicted vs actual species
predicted_species
## model accuracy
# Calculate accuracy
accuracy <- mean(predicted_species == test_data$species)
accuracy
# Confusion matrix
table(
Actual = test_data$species,
Predicted = predicted_species
)
###densityplot showng frequency distributionss of the species
bat_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density plot of Call frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
##scaterplot showing time between calls and frequency
bat_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time between calls vs Frequency",
x = "Time between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
##create a standardized frequency variable
bat_data <- bat_data %>%
mutate(
frequency_z =scale(frequency) %>% as.numeric()#convert to numerc
)
#check updated dataset
glimpse(bat_data)
View(test_data)
library(tidyverse)
library(janitor)
library(knitr)
#load random forest library
library(randomForest)
install.packages("randomForest")
#load random forest library
library(randomForest)
#train a Random Forest model
set.seed(123)  # for reproducibility
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,      # number of trees
mtry = 2          # number of variables tried per split
)
#readcsv file
bat_species_data <- read_csv("Bat_Call_Data.csv")
##View the first few rows of th impoteed data
head(bat_species_data)
#inspect structure of imported data
glimpse(bat_species_data)
#defining the variable types from the dataset
bat_species_data <- bat_species_data %>%
clean_names() %>%
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
# Confirm the changes made to variable types
glimpse(bat_species_data)
##identify duplicated rows from the data
duplicates <- bat_species_data %>% duplicated()
sum(duplicates)#number of duplicate rows
bat_species_data <- bat_species_data %>% distinct()#remove dulicate rows
sum(duplicated(bat_species_data))
#arrange data by species & then by filename
bat_species_data <- bat_species_data %>% arrange(species, filename)
#display aranged data
head(bat_species_data)
##Summary statistics grouped by species
summary_table <- bat_species_data %>%
group_by(species) %>%        # Group by species
summarise(
mean_duration = mean(duration, na.rm = TRUE),
sd_duration = sd(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
summary_table
##create a standardized frequency variable
bat_species_data <- bat_species_data %>%
mutate(
frequency_z =scale(frequency) %>% as.numeric()#convert to numerc
)
#check updated data set struct
glimpse(bat_species_data)
##create sumary table with selected statistics
summary_table <- bat_species_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
###boxplot of frequency across species
bat_species_data %>%
ggplot(aes(x = species, y = frequency, fill =species)) +
geom_boxplot() +
labs(
title = "Frequency distribution by species",
x = "Species",
y= "Frequency (kHz)"
) +
theme_minimal()
###densityplot showng frequency distributionss of the species
bat_species_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density plot of Call frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
#load random forest library
library(randomForest)
#train a Random Forest model
set.seed(123)  # for reproducibility
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,      # number of trees
mtry = 2          # number of variables tried per split
)
set.seed(123)
##cCreate an index for 70% training data
train_index <- sample(
1:nrow(bat_species_data),
size = 0.7 * nrow(bat_species_data)
)
#split the data
train_data <- bat_species_data[train_index, ]
test_data  <- bat_species_data[-train_index, ]
#load random forest library
library(randomForest)
#train a Random Forest model
set.seed(123)  # for reproducibility
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,      # number of trees
mtry = 2          # number of variables tried per split
)
#print model summary
rf_model
library(randomForest)
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
library(randomForest)
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
set.seed(123)
##cCreate an index for 70% training data
train_index <- sample(
1:nrow(bat_species_data),
size = 0.7 * nrow(bat_species_data)
)
#split the data
train_data <- bat_species_data[train_index, ]
test_data  <- bat_species_data[-train_index, ]
library(randomForest)
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
rf_predictions <- predict(rf_model, newdata = test_data)
rf_predictions <- predict(rf_model, newdata = test_data)
rf_predictions <- predict(rf_model, newdata = test_data)
table(
Actual = test_data$species,
Predicted = rf_predictions
)
rf_predictions <- predict(rf_model, newdata = test_data)
rf_predictions
rf_accuracy <- mean(rf_predictions == test_data$species)
rf_accuracy
set.seed(123)
##cCreate an index for 70% training data
train_index <- sample(
1:nrow(bat_species_data),
size = 0.7 * nrow(bat_species_data)
)
#split the data
train_data <- bat_species_data[train_index, ]
test_data  <- bat_species_data[-train_index, ]
library(randomForest)
rf_model <- randomForest(
species ~ duration + frequency + time_btw_calls + slope,
data = train_data,
ntree = 300,
mtry = 2
)
#define variable type for this dataset
bat_species_data <- bat_species_data %>%
clean_names() %>% ##change interpratable format like removing spaces.
mutate(
species = as.factor(species),
filename = as.character(filename),
time_btw_calls = as.numeric(time_btw_calls),
duration = as.numeric(duration),
frequency = as.numeric(frequency),
slope = as.numeric(slope)
)
##view the changes in the structure
glimpse(bat_species_data)
##rearrange by species and filename
bat_species_data <- bat_species_data %>% arrange(species, filename)
#view arrange data
head(bat_species_data)
##Summary statistics grouped by species
summary_by_species <- bat_species_data %>%
group_by(species) %>% #group them by the species
summarise(
mean_duration = mean(duration, na.rm = TRUE),
sd_duration = sd(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
sd_frequency = sd(frequency, na.rm = TRUE),
mean_time_btw = mean(time_btw_calls, na.rm = TRUE),
sd_time_btw = sd(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE),
sd_slope = sd(slope, na.rm = TRUE)
)
#dispay summary
summary_by_species
##create sumary table with selected statistics
summary_table <- bat_species_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(summary_table, caption = "Summary Statistics for Each Bat Species")
#create statistics summay table for species with selected parameters
species_summary_table <- bat_species_data %>%
group_by(species) %>%
summarise(
n = n(),
mean_duration = mean(duration, na.rm = TRUE),
mean_frequency = mean(frequency, na.rm = TRUE),
mean_time_btw_calls = mean(time_btw_calls, na.rm = TRUE),
mean_slope = mean(slope, na.rm = TRUE)
)
##display table
kable(species_summary_table, caption = "Summary Statistics for every bat Species")
bat_species_data %>%
ggplot(aes(x = species, y = frequency, fill =species)) +
geom_boxplot() +
labs(
title = "Frequency distribution by species",
x = "Species",
y= "Frequency (kHz)"
) +
theme_minimal()
bat_species_data %>%
ggplot(aes(x = time_btw_calls, y = frequency, color = species)) +
geom_point(size = 3, alpha = 0.7) +
labs(
title = "Time between calls vs Frequency",
x = "Time between Calls (ms)",
y = "Frequency (kHz)"
) +
theme_minimal()
##densityplot to show the distribution of species to frequency
bat_species_data %>%
ggplot(aes(x = frequency, color = species, fill = species)) +
geom_density(alpha = 0.3) +
labs(
title = "Density plot of Call frequency",
x = "Frequency (kHz)",
y = "Density"
) +
theme_minimal()
